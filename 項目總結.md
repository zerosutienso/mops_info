# 台灣證交所重大訊息查詢 CLI 項目總結

## 項目概述

本項目成功實現了一個用 Rust 開發的命令列工具，用於查詢台灣證券交易所的重大訊息公告。

## 主要功能

✅ **基本查詢功能**
- 查詢指定日期的重大訊息（預設為當日）
- 支援民國年份轉換（自動將西元年轉為民國年）
- 處理無資料情況的友善提示

✅ **篩選功能**
- 依公司代號篩選特定公司的重大訊息

✅ **多種輸出格式**
- 表格格式：適合人類閱讀的控制台輸出
- JSON 格式：適合程式處理和 API 整合
- HTML 格式：保存原始網頁回應
- TXT 格式：純文字檔案，適合報告和存檔

✅ **命令列介面**
- 使用 clap 實現完整的 CLI 參數解析
- 支援 `--help` 顯示使用說明
- 參數驗證和錯誤處理

✅ **檔案輸出功能**
- 自動產生帶日期的檔案名稱
- 支援自訂輸出檔案前綴
- 同時支援多種格式輸出

## 技術架構

### 核心依賴
- **reqwest**: HTTP 客戶端，用於發送請求到證交所 API
- **scraper**: HTML 解析，處理回應內容
- **clap**: 命令列參數解析
- **chrono**: 日期時間處理
- **serde**: 序列化/反序列化
- **tokio**: 異步運行時

### 程式結構
```
src/main.rs
├── Args struct          # 命令列參數定義
├── Announcement struct  # 重大訊息資料結構
├── TwseClient          # 證交所 API 客戶端
│   ├── new()           # 建立 HTTP 客戶端
│   ├── fetch_announcements() # 發送請求獲取資料
│   ├── parse_response()      # 解析 HTML 回應
│   ├── parse_text_content()  # 解析文字內容
│   └── parse_announcement_line() # 解析單行公告
├── parse_date()        # 日期解析
├── get_today()         # 獲取今日日期
└── print_table()       # 表格格式輸出
```

## 實現細節

### HTTP 請求
- 模擬瀏覽器請求，包含必要的 headers
- 使用 POST 方法發送表單資料
- 正確處理民國年份轉換

### HTML 解析
- 使用 scraper 解析 HTML 回應
- 處理證交所特殊的表格結構
- 智能識別無資料情況

### 錯誤處理
- 網路錯誤處理
- 日期格式驗證
- 友善的錯誤訊息

## 使用範例

```bash
# 查詢今日重大訊息
cargo run

# 查詢指定日期（使用有資料的日期）
cargo run -- --date 2025-08-15

# 查詢特定公司
cargo run -- --company 2330 --date 2025-08-15

# JSON 格式輸出
cargo run -- --format json --date 2025-08-15

# 儲存原始 HTML
cargo run -- --save-html --date 2025-08-15

# TXT 格式輸出
cargo run -- --format txt --date 2025-08-15

# 完整功能展示
cargo run -- --date 2025-08-15 --company 2882 --save-html --output cathay_financial

# 顯示幫助
cargo run -- --help
```

## 編譯和部署

### 開發版本
```bash
cargo run
```

### 發布版本
```bash
cargo build --release
./target/release/twse-announcements.exe
```

## 項目特色

1. **高效能**: 使用 Rust 開發，執行速度快，記憶體使用少
2. **易用性**: 簡潔的命令列介面，預設查詢當日資料
3. **靈活性**: 支援多種輸出格式和篩選選項
4. **穩定性**: 完善的錯誤處理和邊界情況處理
5. **可維護性**: 清晰的程式結構和充分的註解

## 未來改進方向

1. **資料快取**: 實現本地快取機制，避免重複請求
2. **更多篩選**: 支援按訊息類型、關鍵字篩選
3. **資料匯出**: 支援 CSV、Excel 等格式匯出
4. **定時查詢**: 實現定時查詢和通知功能
5. **圖形介面**: 開發 GUI 版本提升使用體驗

## 學習收穫

1. **Rust 異步程式設計**: 掌握 tokio 和 async/await 的使用
2. **HTTP 客戶端開發**: 學會使用 reqwest 進行網路請求
3. **HTML 解析**: 使用 scraper 處理複雜的 HTML 結構
4. **CLI 工具開發**: 使用 clap 建立專業的命令列工具
5. **錯誤處理**: Rust 的錯誤處理最佳實踐

## 結論

本項目成功實現了一個功能完整、易於使用的台灣證交所重大訊息查詢工具。透過 Rust 的強大功能和豐富的生態系統，我們建立了一個高效、穩定且易於維護的 CLI 應用程式。這個工具可以幫助投資者和研究人員快速獲取最新的重大訊息，提升工作效率。
