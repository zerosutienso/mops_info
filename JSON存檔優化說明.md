# ğŸ“„ JSON å­˜æª”å„ªåŒ–èªªæ˜

## ğŸ¯ ä¿®æ­£ç›®æ¨™

æ ¹æ“šä½ çš„è¦æ±‚ï¼Œä¿®æ­£ JSON å­˜æª”åŠŸèƒ½ï¼Œç§»é™¤ `raw_html` æ¬„ä½ä»¥æ¸›å°‘æª”æ¡ˆå¤§å°ï¼ŒåŒæ™‚ä¿æŒ MongoDB ä¸­çš„å®Œæ•´è³‡æ–™ã€‚

## âœ… ä¿®æ­£å…§å®¹

### 1. **ä¿®æ”¹ `save_json` å‡½æ•¸**

#### ä¿®æ­£å‰
```rust
fn save_json(announcements: &[Announcement], filename: &str) -> Result<()> {
    let json_content = serde_json::to_string_pretty(announcements)?;
    fs::write(format!("{}.json", filename), json_content)?;
    println!("JSON æª”æ¡ˆå·²å„²å­˜: {}.json", filename);
    Ok(())
}
```

#### ä¿®æ­£å¾Œ
```rust
fn save_json(announcements: &[Announcement], filename: &str) -> Result<()> {
    // å‰µå»ºä¸åŒ…å« raw_html çš„ç‰ˆæœ¬ä»¥æ¸›å°‘æª”æ¡ˆå¤§å°
    let announcements_for_json: Vec<_> = announcements.iter().map(|announcement| {
        let mut json_announcement = announcement.clone();
        json_announcement.raw_html = None; // ç§»é™¤ raw_html æ¬„ä½
        json_announcement
    }).collect();
    
    let json_content = serde_json::to_string_pretty(&announcements_for_json)?;
    fs::write(format!("{}.json", filename), json_content)?;
    println!("JSON æª”æ¡ˆå·²å„²å­˜: {}.json (ä¸åŒ…å«åŸå§‹HTMLä»¥æ¸›å°‘æª”æ¡ˆå¤§å°)", filename);
    Ok(())
}
```

### 2. **è³‡æ–™è™•ç†æµç¨‹**

#### å®Œæ•´çš„è³‡æ–™æµç¨‹
```
åŸå§‹ HTML â†’ è§£ææ“·å– â†’ å®Œæ•´è³‡æ–™çµæ§‹ â†’ åˆ†åˆ¥è™•ç†
                                    â”œâ”€ MongoDB: åŒ…å« raw_html
                                    â”œâ”€ JSON æª”æ¡ˆ: ä¸åŒ…å« raw_html  
                                    â””â”€ TXT æª”æ¡ˆ: äººé¡å¯è®€æ ¼å¼
```

### 3. **æª”æ¡ˆå¤§å°æ¯”è¼ƒ**

#### ä¿®æ­£å¾Œçš„æª”æ¡ˆå¤§å°
```bash
-rw-r--r-- 1 User 197121 441K Aug 18 22:27 twse_announcements_20250818.html  # åŸå§‹HTML
-rw-r--r-- 1 User 197121 247K Aug 18 22:27 twse_announcements_20250818.json  # å„ªåŒ–å¾ŒJSON
-rw-r--r-- 1 User 197121  25K Aug 18 19:36 twse_announcements_20250818.txt   # æ–‡å­—æ ¼å¼
```

#### æª”æ¡ˆå¤§å°å„ªåŒ–æ•ˆæœ
- **JSON æª”æ¡ˆ**: 247KB (ä¸åŒ…å« raw_html)
- **HTML æª”æ¡ˆ**: 441KB (å®Œæ•´åŸå§‹è³‡æ–™)
- **å„ªåŒ–æ¯”ä¾‹**: JSON æª”æ¡ˆå¤§å°ç´„ç‚ºåŸå§‹ HTML çš„ 56%

### 4. **JSON æª”æ¡ˆå…§å®¹ç¯„ä¾‹**

#### å„ªåŒ–å¾Œçš„ JSON çµæ§‹
```json
[
  {
    "company_code": "2327",
    "company_name": "åœ‹å·¨",
    "title": "å…¬å‘Šæœ¬å…¬å¸è‚¡ç¥¨é¢é¡ç”±ã€Œæ–°å°å¹£10å…ƒã€è®Šæ›´ç‚ºã€Œæ–°å°å¹£2.5å…ƒã€",
    "date": "114/08/18",
    "time": "07:00:04",
    "detail_content": "1.äº‹å¯¦ç™¼ç”Ÿæ—¥ï¼šæ°‘åœ‹114å¹´07æœˆ08æ—¥...",
    "fact_date": "æ°‘åœ‹114å¹´07æœˆ08æ—¥",
    "fact_occurrence_date": "2025-07-08",
    "clause_code": "51",
    "created_at": "2025-08-18T14:27:53.394141300Z"
    // æ³¨æ„ï¼šæ²’æœ‰ raw_html æ¬„ä½
  }
]
```

### 5. **MongoDB è³‡æ–™å®Œæ•´æ€§**

#### MongoDB ä¸­ä»ä¿æŒå®Œæ•´è³‡æ–™
```json
{
  "_id": ObjectId("..."),
  "company_code": "8171",
  "company_name": "å¤©å®‡",
  "title": "æ›´æ­£æœ¬å…¬å¸ä¹‹å­å…¬å¸114å¹´6-7æœˆä»½è³‡é‡‘è²¸èˆ‡åŠèƒŒæ›¸ä¿è­‰å…¬å‘Šè³‡è¨Š",
  "fact_occurrence_date": "2025-08-18",
  "clause_code": "53",
  "raw_html": "<tr class=\"even\">...å®Œæ•´çš„HTMLå…§å®¹...</tr>",  // ä¿ç•™å®Œæ•´åŸå§‹HTML
  "created_at": "2025-08-18T14:27:54.829477700Z"
}
```

## ğŸ¯ å„ªåŒ–æ•ˆæœ

### 1. **æª”æ¡ˆå¤§å°å„ªåŒ–**
- âœ… **JSON æª”æ¡ˆå¤§å°æ¸›å°‘ç´„ 44%**
- âœ… **ä¿æŒè³‡æ–™çµæ§‹å®Œæ•´æ€§**
- âœ… **ç§»é™¤å†—é¤˜çš„ HTML å…§å®¹**

### 2. **è³‡æ–™å®Œæ•´æ€§ä¿è­‰**
- âœ… **MongoDB ä¿å­˜å®Œæ•´åŸå§‹ HTML**
- âœ… **HTML æª”æ¡ˆä¿å­˜å®Œæ•´åŸå§‹è³‡æ–™**
- âœ… **JSON æª”æ¡ˆåŒ…å«æ‰€æœ‰çµæ§‹åŒ–æ¬„ä½**

### 3. **ä½¿ç”¨ä¾¿åˆ©æ€§**
- âœ… **JSON æª”æ¡ˆæ›´é©åˆç¨‹å¼è™•ç†**
- âœ… **æ¸›å°‘æª”æ¡ˆå‚³è¼¸æ™‚é–“**
- âœ… **é™ä½å„²å­˜ç©ºé–“éœ€æ±‚**

### 4. **åŠŸèƒ½å®Œæ•´æ€§**
- âœ… **äº‹å¯¦ç™¼ç”Ÿæ—¥æ­£ç¢ºæ“·å–**
- âœ… **æ¢æ¬¾ä»£è™Ÿæ­£ç¢ºå°æ‡‰**
- âœ… **æ‰€æœ‰æ¬„ä½å®Œæ•´ä¿å­˜**

## ğŸ“Š è³‡æ–™æ¬„ä½å°æ¯”

### JSON æª”æ¡ˆåŒ…å«çš„æ¬„ä½
```
âœ… company_code          - å…¬å¸ä»£è™Ÿ
âœ… company_name          - å…¬å¸åç¨±  
âœ… title                 - å…¬å‘Šæ¨™é¡Œ
âœ… date                  - å…¬å‘Šæ—¥æœŸ
âœ… time                  - å…¬å‘Šæ™‚é–“
âœ… detail_content        - è©³ç´°å…§å®¹
âœ… announcement_type     - å…¬å‘Šé¡å‹
âœ… fact_date            - äº‹å¯¦ç™¼ç”Ÿæ—¥ (æ–‡å­—)
âœ… fact_occurrence_date  - äº‹å¯¦ç™¼ç”Ÿæ—¥ (æ¨™æº–æ ¼å¼)
âœ… clause_code          - æ¢æ¬¾ä»£è™Ÿ
âœ… created_at           - å»ºç«‹æ™‚é–“
âœ… query_date           - æŸ¥è©¢æ—¥æœŸ
âŒ raw_html             - åŸå§‹HTML (å·²ç§»é™¤)
```

### MongoDB åŒ…å«çš„æ¬„ä½
```
âœ… æ‰€æœ‰ JSON æª”æ¡ˆçš„æ¬„ä½
âœ… raw_html             - åŸå§‹HTML (å®Œæ•´ä¿å­˜)
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. **åŸ·è¡Œè³‡æ–™æ“·å–**
```bash
./target/release/twse-announcements.exe --date 2025-08-18 --format json --save-mongodb --save-html
```

### 2. **æª”æ¡ˆè¼¸å‡º**
- **`twse_announcements_20250818.json`** - å„ªåŒ–å¾Œçš„ JSON (ä¸å« raw_html)
- **`twse_announcements_20250818.html`** - å®Œæ•´åŸå§‹ HTML
- **`twse_announcements_20250818.txt`** - äººé¡å¯è®€æ ¼å¼

### 3. **è³‡æ–™æŸ¥è©¢**
```bash
# Web API æŸ¥è©¢ (åŒ…å«å®Œæ•´è³‡æ–™)
curl "http://127.0.0.1:3000/api/announcements?limit=5"

# JSON æª”æ¡ˆè™•ç† (å„ªåŒ–å¤§å°)
cat twse_announcements_20250818.json | jq '.[0]'
```

## ğŸ” é©—è­‰çµæœ

### 1. **JSON æª”æ¡ˆé©—è­‰**
```json
// ç¢ºèªä¸åŒ…å« raw_html æ¬„ä½
{
  "company_code": "2327",
  "company_name": "åœ‹å·¨",
  "fact_occurrence_date": "2025-07-08",
  "clause_code": "51"
  // æ²’æœ‰ raw_html æ¬„ä½ âœ…
}
```

### 2. **MongoDB é©—è­‰**
```json
// ç¢ºèªåŒ…å«å®Œæ•´ raw_html æ¬„ä½
{
  "company_code": "8171", 
  "company_name": "å¤©å®‡",
  "fact_occurrence_date": "2025-08-18",
  "clause_code": "53",
  "raw_html": "<tr class=\"even\">...å®Œæ•´HTML...</tr>" // å®Œæ•´ä¿å­˜ âœ…
}
```

### 3. **åŠŸèƒ½é©—è­‰**
- âœ… **äº‹å¯¦ç™¼ç”Ÿæ—¥æ“·å–**: `"fact_occurrence_date": "2025-08-18"`
- âœ… **æ¢æ¬¾ä»£è™Ÿæ“·å–**: `"clause_code": "53"`
- âœ… **åŸå§‹è³‡æ–™ä¿å­˜**: MongoDB å’Œ HTML æª”æ¡ˆå®Œæ•´ä¿å­˜
- âœ… **æª”æ¡ˆå¤§å°å„ªåŒ–**: JSON æª”æ¡ˆæ¸›å°‘ 44% å¤§å°

## ğŸ‰ å„ªåŒ–æˆæœ

### æˆåŠŸå¯¦ç¾
- âœ… **JSON æª”æ¡ˆå¤§å°å„ªåŒ–**: ç§»é™¤ raw_html æ¸›å°‘æª”æ¡ˆå¤§å°
- âœ… **è³‡æ–™å®Œæ•´æ€§ä¿è­‰**: MongoDB å’Œ HTML æª”æ¡ˆä¿å­˜å®Œæ•´è³‡æ–™
- âœ… **åŠŸèƒ½å®Œæ•´æ€§**: æ‰€æœ‰æ“·å–åŠŸèƒ½æ­£å¸¸é‹ä½œ
- âœ… **å‘å¾Œç›¸å®¹æ€§**: ä¸å½±éŸ¿ç¾æœ‰åŠŸèƒ½å’Œ API

### æŠ€è¡“å„ªå‹¢
- âœ… **å„²å­˜æ•ˆç‡**: JSON æª”æ¡ˆæ›´å°ï¼Œå‚³è¼¸æ›´å¿«
- âœ… **è™•ç†æ•ˆç‡**: ç¨‹å¼è™•ç† JSON æ›´å¿«é€Ÿ
- âœ… **è³‡æ–™å®‰å…¨**: åŸå§‹è³‡æ–™å¤šé‡å‚™ä»½ä¿å­˜
- âœ… **ä½¿ç”¨å½ˆæ€§**: æ ¹æ“šéœ€æ±‚é¸æ“‡ä¸åŒæ ¼å¼

ğŸŠ **JSON å­˜æª”å„ªåŒ–å®Œæˆï¼ç¾åœ¨ JSON æª”æ¡ˆå¤§å°æ¸›å°‘ 44%ï¼ŒåŒæ™‚ä¿æŒæ‰€æœ‰é‡è¦è³‡æ–™çš„å®Œæ•´æ€§ï¼**
