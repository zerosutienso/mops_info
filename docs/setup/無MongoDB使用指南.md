# ç„¡ MongoDB ä½¿ç”¨æŒ‡å—

## ğŸ¯ æ¦‚è¿°

å³ä½¿æ²’æœ‰å®‰è£ MongoDBï¼Œæˆ‘å€‘çš„ CLI å·¥å…·ä»ç„¶æä¾›å®Œæ•´çš„åŠŸèƒ½ï¼ä½ å¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„æŸ¥è©¢å’Œæª”æ¡ˆè¼¸å‡ºåŠŸèƒ½ã€‚

## âœ… å¯ç”¨åŠŸèƒ½

### 1. ğŸ” å®Œæ•´æŸ¥è©¢åŠŸèƒ½
- æŸ¥è©¢æŒ‡å®šæ—¥æœŸçš„é‡å¤§è¨Šæ¯
- ç¯©é¸ç‰¹å®šå…¬å¸
- æ”¯æ´æ‰€æœ‰è¼¸å‡ºæ ¼å¼

### 2. ğŸ“Š å¤šæ ¼å¼è¼¸å‡º
- **è¡¨æ ¼æ ¼å¼**: æ•´é½Šçš„æ§åˆ¶å°é¡¯ç¤º
- **JSON æ ¼å¼**: åŒ…å«å®Œæ•´è©³ç´°è³‡æ–™
- **TXT æ ¼å¼**: ç´”æ–‡å­—æª”æ¡ˆ
- **HTML æ ¼å¼**: åŸå§‹ç¶²é å…§å®¹

### 3. ğŸ’¾ æª”æ¡ˆå„²å­˜
- è‡ªå‹•å„²å­˜åˆ°æª”æ¡ˆ
- è‡ªè¨‚æª”æ¡ˆåç¨±
- åŒ…å«æ—¥æœŸçš„æª”æ¡ˆå‘½å

## ğŸš€ ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬æŸ¥è©¢
```bash
# æŸ¥è©¢ä»Šæ—¥é‡å¤§è¨Šæ¯
cargo run

# æŸ¥è©¢æŒ‡å®šæ—¥æœŸ
cargo run -- --date 2025-08-15

# æŸ¥è©¢ç‰¹å®šå…¬å¸
cargo run -- --date 2025-08-15 --company 2330
```

### JSON æ ¼å¼ï¼ˆæ¨è–¦ï¼‰
```bash
# å°ç©é›»è©³ç´°è³‡æ–™
cargo run -- --date 2025-08-15 --company 2330 --format json

# åœ‹æ³°é‡‘è©³ç´°è³‡æ–™
cargo run -- --date 2025-08-15 --company 2882 --format json

# ç•¶æ—¥æ‰€æœ‰è³‡æ–™
cargo run -- --date 2025-08-15 --format json
```

### TXT æ ¼å¼
```bash
# ç´”æ–‡å­—æ ¼å¼ï¼Œæ˜“æ–¼é–±è®€
cargo run -- --date 2025-08-15 --format txt

# è‡ªè¨‚æª”æ¡ˆåç¨±
cargo run -- --date 2025-08-15 --company 2882 --format txt --output cathay_report
```

### HTML æ ¼å¼
```bash
# ä¿å­˜åŸå§‹ç¶²é 
cargo run -- --date 2025-08-15 --format html --save-html
```

## ğŸ“ æª”æ¡ˆç®¡ç†

### è‡ªå‹•ç”Ÿæˆçš„æª”æ¡ˆ
```bash
# åŸ·è¡Œå¾Œæœƒè‡ªå‹•ç”Ÿæˆ
cargo run -- --date 2025-08-15 --format json --output my_data

# ç”Ÿæˆçš„æª”æ¡ˆ
my_data_20250815.json  # JSON æ ¼å¼è³‡æ–™
```

### æª”æ¡ˆå‘½åè¦å‰‡
- æ ¼å¼ï¼š`{å‰ç¶´}_{YYYYMMDD}.{å‰¯æª”å}`
- ç¯„ä¾‹ï¼š
  - `twse_announcements_20250815.json`
  - `cathay_report_20250815.txt`
  - `tsmc_data_20250815.html`

## ğŸ“Š å¯¦éš›æ¸¬è©¦ç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šæŸ¥è©¢å°ç©é›»
```bash
cargo run -- --date 2025-08-15 --company 2330 --format json
```

**è¼¸å‡º**ï¼š
```json
[
  {
    "company_code": "2330",
    "company_name": "å°ç©é›»",
    "title": "æœ¬å…¬å¸ä»£å­å…¬å¸ TSMC Global Ltd. å…¬å‘Šå–å¾—å›ºå®šæ”¶ç›Šè­‰åˆ¸",
    "date": "114/08/15",
    "time": "17:40:31",
    "detail_content": "1.è­‰åˆ¸åç¨±:\nå…¬å¸å‚µã€‚\n2.äº¤æ˜“æ—¥æœŸ:114/8/12~114/8/15...",
    "created_at": "2025-08-17T17:35:24.374884700Z"
  }
]
```

### ç¯„ä¾‹ 2ï¼šæŸ¥è©¢åœ‹æ³°é‡‘
```bash
cargo run -- --date 2025-08-15 --company 2882 --format txt
```

**è¼¸å‡ºæª”æ¡ˆ** (`twse_announcements_20250815.txt`)ï¼š
```
å°ç£è­‰äº¤æ‰€é‡å¤§è¨Šæ¯
==================

ä»£è™Ÿ     å…¬å¸åç¨±             æ—¥æœŸ       æ™‚é–“     æ¨™é¡Œ
--------------------------------------------------------------------------------
2882     åœ‹æ³°é‡‘              114/08/15  16:51:09 å…¬å‘Šæœ¬å…¬å¸è‘£äº‹æœƒé€šé114å¹´ä¸ŠåŠå¹´åº¦æ±ºç®—è²¡å‹™å ±å‘Š
2882     åœ‹æ³°é‡‘              114/08/15  16:51:40 å…¬å‘Šæœ¬å…¬å¸æ–°è¨­æ°¸çºŒé•·
2882     åœ‹æ³°é‡‘              114/08/15  16:52:13 å…¬å‘Šæœ¬å…¬å¸ã€Œé¢¨éšªç®¡ç†å§”å“¡æœƒã€æ›´åç‚º ã€Œé¢¨éšªç®¡ç†æš¨è³‡è¨Šå®‰å…¨å§”å“¡æœƒã€æš¨æˆå“¡è®Šå‹•
...
```

### ç¯„ä¾‹ 3ï¼šæŸ¥è©¢ç•¶æ—¥æ‰€æœ‰è³‡æ–™
```bash
cargo run -- --date 2025-08-15 --format json
```

**çµæœ**ï¼š400+ ç­†é‡å¤§è¨Šæ¯ï¼ŒåŒ…å«å®Œæ•´è©³ç´°è³‡æ–™

## ğŸ” è³‡æ–™åˆ†æ

### ä½¿ç”¨ JSON æª”æ¡ˆé€²è¡Œåˆ†æ

#### 1. ä½¿ç”¨ jq å·¥å…·ï¼ˆéœ€å¦å¤–å®‰è£ï¼‰
```bash
# çµ±è¨ˆå„å…¬å¸å…¬å‘Šæ•¸é‡
cat twse_announcements_20250815.json | jq 'group_by(.company_code) | map({company: .[0].company_name, count: length}) | sort_by(.count) | reverse'

# æŸ¥è©¢åŒ…å«ç‰¹å®šé—œéµå­—çš„å…¬å‘Š
cat twse_announcements_20250815.json | jq '.[] | select(.title | contains("è²¡å‹™å ±å‘Š"))'
```

#### 2. ä½¿ç”¨ Python åˆ†æ
```python
import json
import pandas as pd

# è®€å– JSON æª”æ¡ˆ
with open('twse_announcements_20250815.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# è½‰æ›ç‚º DataFrame
df = pd.DataFrame(data)

# çµ±è¨ˆåˆ†æ
print("å„å…¬å¸å…¬å‘Šæ•¸é‡:")
print(df['company_name'].value_counts().head(10))

print("\nåŒ…å«é—œéµå­—çš„å…¬å‘Š:")
keyword_announcements = df[df['title'].str.contains('è²¡å‹™å ±å‘Š', na=False)]
print(keyword_announcements[['company_name', 'title']])
```

#### 3. ä½¿ç”¨ Excel åˆ†æ
1. é–‹å•Ÿ Excel
2. è³‡æ–™ â†’ å–å¾—è³‡æ–™ â†’ å¾æª”æ¡ˆ â†’ å¾ JSON
3. é¸æ“‡ç”Ÿæˆçš„ JSON æª”æ¡ˆ
4. å±•é–‹è³‡æ–™é€²è¡Œåˆ†æ

## ğŸ“ˆ æ‰¹æ¬¡è™•ç†

### æ”¶é›†æ­·å²è³‡æ–™
```bash
# Windows æ‰¹æ¬¡æª”æ¡ˆ (collect_history.bat)
@echo off
for /L %%i in (1,1,31) do (
    echo æ­£åœ¨è™•ç† 2025-08-%%i...
    cargo run -- --date 2025-08-%%i --format json --output history_%%i
)
echo æ­·å²è³‡æ–™æ”¶é›†å®Œæˆï¼
```

### ç›£æ§ç‰¹å®šå…¬å¸
```bash
# ç›£æ§å°ç©é›» (monitor_tsmc.bat)
@echo off
:loop
echo %date% %time% - æŸ¥è©¢å°ç©é›»æœ€æ–°å…¬å‘Š
cargo run -- --company 2330 --format json --output tsmc_latest
timeout /t 3600
goto loop
```

## ğŸ› ï¸ é€²éšæŠ€å·§

### 1. çµ„åˆæŸ¥è©¢
```bash
# æŸ¥è©¢å¤šå®¶å…¬å¸ï¼ˆéœ€è¦åˆ†åˆ¥åŸ·è¡Œï¼‰
cargo run -- --date 2025-08-15 --company 2330 --format json --output tsmc
cargo run -- --date 2025-08-15 --company 2317 --format json --output foxconn
cargo run -- --date 2025-08-15 --company 2882 --format json --output cathay
```

### 2. è³‡æ–™é©—è­‰
```bash
# æª¢æŸ¥æ˜¯å¦æœ‰è³‡æ–™
cargo run -- --date 2025-08-15 --company 9999
# å¦‚æœå…¬å¸ä»£è™Ÿä¸å­˜åœ¨ï¼Œæœƒé¡¯ç¤º "ä»Šæ—¥ç„¡é‡å¤§è¨Šæ¯å…¬å‘Š"
```

### 3. æ•ˆèƒ½æ¸¬è©¦
```bash
# æ¸¬è©¦å¤§é‡è³‡æ–™æŸ¥è©¢
time cargo run -- --date 2025-08-15 --format json
```

## ğŸ’¡ å¯¦ç”¨å»ºè­°

### 1. æª”æ¡ˆç®¡ç†
- å»ºç«‹å°ˆé–€çš„è³‡æ–™å¤¾å„²å­˜è¼¸å‡ºæª”æ¡ˆ
- ä½¿ç”¨æœ‰æ„ç¾©çš„æª”æ¡ˆå‰ç¶´åç¨±
- å®šæœŸæ¸…ç†èˆŠæª”æ¡ˆ

### 2. è³‡æ–™åˆ†æ
- JSON æ ¼å¼æœ€é©åˆç¨‹å¼è™•ç†
- TXT æ ¼å¼æœ€é©åˆäººå·¥é–±è®€
- HTML æ ¼å¼ä¿ç•™å®Œæ•´åŸå§‹è³‡æ–™

### 3. è‡ªå‹•åŒ–
- ä½¿ç”¨æ‰¹æ¬¡æª”æ¡ˆé€²è¡Œå®šæœŸæŸ¥è©¢
- çµåˆå·¥ä½œæ’ç¨‹å™¨å¯¦ç¾è‡ªå‹•åŒ–
- å»ºç«‹ç›£æ§è…³æœ¬è¿½è¹¤ç‰¹å®šå…¬å¸

## ğŸ¯ æœªä¾†å‡ç´š

ç•¶ä½ æº–å‚™å¥½ä½¿ç”¨ MongoDB æ™‚ï¼š

1. **å®‰è£ MongoDB**ï¼šåƒè€ƒ `MongoDBå¿«é€Ÿå®‰è£æŒ‡å—.md`
2. **æ¸¬è©¦é€£æ¥**ï¼šåŸ·è¡Œ `.\mongodb_setup.bat`
3. **é–‹å§‹ä½¿ç”¨**ï¼šåŠ å…¥ `--save-mongodb` åƒæ•¸

```bash
# å‡ç´šåˆ° MongoDB ç‰ˆæœ¬
cargo run -- --date 2025-08-15 --format json --save-mongodb
```

## ğŸ† ç¸½çµ

å³ä½¿æ²’æœ‰ MongoDBï¼Œæˆ‘å€‘çš„ CLI å·¥å…·ä»ç„¶æ˜¯ä¸€å€‹å¼·å¤§çš„å°ç£è­‰äº¤æ‰€é‡å¤§è¨Šæ¯æŸ¥è©¢å·¥å…·ï¼š

- âœ… **å®Œæ•´åŠŸèƒ½**ï¼šæ‰€æœ‰æŸ¥è©¢å’Œè¼¸å‡ºåŠŸèƒ½éƒ½å¯æ­£å¸¸ä½¿ç”¨
- âœ… **è©³ç´°è³‡æ–™**ï¼šJSON æ ¼å¼åŒ…å«å®Œæ•´çš„å…¬å‘Šè©³ç´°å…§å®¹
- âœ… **æª”æ¡ˆå„²å­˜**ï¼šè‡ªå‹•å„²å­˜åˆ°å¤šç¨®æ ¼å¼çš„æª”æ¡ˆ
- âœ… **è³‡æ–™åˆ†æ**ï¼šå¯ä½¿ç”¨å„ç¨®å·¥å…·åˆ†æ JSON è³‡æ–™
- âœ… **è‡ªå‹•åŒ–**ï¼šæ”¯æ´æ‰¹æ¬¡è™•ç†å’Œç›£æ§

é€™å·²ç¶“æ˜¯ä¸€å€‹éå¸¸å¯¦ç”¨çš„é‡‘èè³‡æ–™æŸ¥è©¢å·¥å…·äº†ï¼ğŸ‰
