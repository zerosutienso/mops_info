# ğŸ“‹ æ¢æ¬¾ä»£è™Ÿæ“·å–åŠŸèƒ½å¯¦ç¾èªªæ˜

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

æ ¹æ“šä½ çš„è¦æ±‚ï¼Œæˆ‘å·²ç¶“æˆåŠŸå¯¦ç¾äº†å¾åŸå§‹ HTML è³‡æ–™ä¸­æ“·å– `name='h06' value='12'` é€™é¡æ¢æ¬¾ä»£è™Ÿçš„åŠŸèƒ½ï¼Œä¸¦å°‡å…¶å­˜å…¥ JSON èˆ‡ MongoDBã€‚

## âœ… å¯¦ç¾å…§å®¹

### 1. **è³‡æ–™çµæ§‹æ“´å±•**

#### æ–°å¢æ¢æ¬¾ä»£è™Ÿæ¬„ä½
```rust
#[derive(Debug, Serialize, Deserialize, Clone)]
struct Announcement {
    // ... åŸæœ‰æ¬„ä½ ...
    #[serde(skip_serializing_if = "Option::is_none")]
    clause_code: Option<String>, // æ–°å¢æ¢æ¬¾ä»£è™Ÿæ¬„ä½
    // ... å…¶ä»–æ¬„ä½ ...
}
```

#### æ›´æ–°æ‰€æœ‰æ¨¡çµ„
- âœ… `src/main.rs` - ä¸»ç¨‹å¼è³‡æ–™çµæ§‹
- âœ… `src/simple_web.rs` - Web æŸ¥è©¢æ¨¡çµ„
- âœ… `src/web_viewer.rs` - Web æª¢è¦–æ¨¡çµ„

### 2. **HTML è§£æé‚è¼¯**

#### æ“·å–æ¢æ¬¾ä»£è™Ÿçš„é‚è¼¯
```rust
fn extract_detail_info(&self, row: &scraper::ElementRef, input_selector: &Selector) 
    -> (Option<String>, Option<String>, Option<String>, Option<String>) {
    
    let mut clause_code = None;
    
    for input in row.select(input_selector) {
        if let Some(name) = input.value().attr("name") {
            if let Some(value) = input.value().attr("value") {
                match name {
                    name if name.ends_with("6") => { // h06, h16, h26 ç­‰
                        if !value.trim().is_empty() {
                            clause_code = Some(value.trim().to_string());
                            println!("ğŸ“‹ æ“·å–æ¢æ¬¾ä»£è™Ÿ: {} = {}", name, value);
                        }
                    }
                    // ... å…¶ä»–æ¬„ä½è™•ç† ...
                }
            }
        }
    }
    
    (detail_content, announcement_type, fact_date, clause_code)
}
```

#### æ“·å–è¦å‰‡
- **ç›®æ¨™æ¬„ä½**: `name` å±¬æ€§ä»¥ "6" çµå°¾çš„ input å…ƒç´ 
- **å¸¸è¦‹æ ¼å¼**: `h06`, `h16`, `h26`, `h36`, `h46`, `h56`, `h66`, `h76`, `h86`, `h96` ç­‰
- **æ¢æ¬¾ä»£è™Ÿ**: å°æ‡‰çš„ `value` å±¬æ€§å€¼

### 3. **èª¿è©¦åŠŸèƒ½å¢å¼·**

#### è©³ç´°çš„æ“·å–æ—¥èªŒ
```rust
println!("ğŸ” ç™¼ç¾ input æ¬„ä½: name='{}', value='{}'", name, value);
println!("ğŸ“‹ æ“·å–æ¢æ¬¾ä»£è™Ÿ: {} = {}", name, value);
println!("ğŸ“ å…¶ä»–æ¬„ä½: {} = {}", name, value);
```

#### å¯¦éš›æ“·å–çµæœ
```
ğŸ” ç™¼ç¾ input æ¬„ä½: name='h06', value='51'
ğŸ“‹ æ“·å–æ¢æ¬¾ä»£è™Ÿ: h06 = 51

ğŸ” ç™¼ç¾ input æ¬„ä½: name='h66', value='12'
ğŸ“‹ æ“·å–æ¢æ¬¾ä»£è™Ÿ: h66 = 12

ğŸ” ç™¼ç¾ input æ¬„ä½: name='h106', value='26'
ğŸ“‹ æ“·å–æ¢æ¬¾ä»£è™Ÿ: h106 = 26
```

## ğŸ¨ Web ä»‹é¢é¡¯ç¤º

### 1. **æ¢æ¬¾ä»£è™Ÿæ¨™ç±¤**

#### åœ¨å…¬å‘Šæ¨™é¡Œæ—é¡¯ç¤ºæ¢æ¬¾ä»£è™Ÿ
```html
<div class="announcement-title">
    ${announcement.title}
    ${announcement.clause_code ? `
    <span class="badge bg-info ms-2">
        <i class="fas fa-gavel me-1"></i>æ¢æ¬¾ ${announcement.clause_code}
    </span>
    ` : ''}
</div>
```

#### è¦–è¦ºæ•ˆæœ
```
ğŸ“‹ å…¬å‘Šæ¨™é¡Œ                                    ğŸ·ï¸ æ¢æ¬¾ 12
è‘£äº‹æœƒæ±ºè­°è‚¡åˆ©åˆ†æ´¾æ¡ˆ                            ğŸ·ï¸ æ¢æ¬¾ 51
æ³•äººèªªæ˜æœƒé‡è¦è³‡è¨Š                              ğŸ·ï¸ æ¢æ¬¾ 26
```

### 2. **CSV åŒ¯å‡ºåŠŸèƒ½**

#### æ–°å¢æ¢æ¬¾ä»£è™Ÿæ¬„ä½
```javascript
const headers = ['å…¬å¸ä»£è™Ÿ', 'å…¬å¸åç¨±', 'æ¨™é¡Œ', 'æ—¥æœŸ', 'æ™‚é–“', 'æ¢æ¬¾ä»£è™Ÿ', 'è©³ç´°å…§å®¹'];

const row = [
    `"${announcement.company_code}"`,
    `"${announcement.company_name}"`,
    `"${announcement.title.replace(/"/g, '""')}"`,
    `"${announcement.date}"`,
    `"${announcement.time}"`,
    `"${announcement.clause_code || ''}"`, // æ¢æ¬¾ä»£è™Ÿ
    `"${(announcement.detail_content || '').replace(/"/g, '""')}"`
];
```

## ğŸ“Š æ¢æ¬¾ä»£è™Ÿçµ±è¨ˆ

### å¸¸è¦‹æ¢æ¬¾ä»£è™ŸåŠå…¶æ„ç¾©

| æ¢æ¬¾ä»£è™Ÿ | å‡ºç¾æ¬¡æ•¸ | ä¸»è¦ç”¨é€” |
|----------|----------|----------|
| 12 | é«˜é » | æ³•äººèªªæ˜æœƒ |
| 51 | é«˜é » | å…¬å¸åç¨±/é¢é¡è®Šæ›´ |
| 26 | ä¸­é » | è£ç½°æ¡ˆä»¶ |
| 31 | ä¸­é » | è‘£äº‹æœƒå¬é–‹ |
| 14 | ä¸­é » | é™¤æ¬Šæ¯äº‹å®œ |
| 53 | ä¸­é » | è½‰æ›å…¬å¸å‚µ |
| 22 | ä½é » | èƒŒæ›¸ä¿è­‰ |
| 23 | ä½é » | è³‡é‡‘è²¸èˆ‡ |

### å¯¦éš›æ“·å–ç¯„ä¾‹

#### æ¢æ¬¾ 12 - æ³•äººèªªæ˜æœƒ
```json
{
  "company_code": "6176",
  "company_name": "ç‘å„€",
  "title": "å…¬å‘Šæœ¬å…¬å¸å—é‚€åƒåŠ åœ‹ç¥¨è­‰åˆ¸èˆ‰è¾¦ä¹‹æ³•äººèªªæ˜æœƒ",
  "clause_code": "12"
}
```

#### æ¢æ¬¾ 51 - å…¬å¸è®Šæ›´
```json
{
  "company_code": "2327",
  "company_name": "åœ‹å·¨",
  "title": "å…¬å‘Šæœ¬å…¬å¸è‚¡ç¥¨é¢é¡ç”±ã€Œæ–°å°å¹£10å…ƒã€è®Šæ›´ç‚ºã€Œæ–°å°å¹£2.5å…ƒã€",
  "clause_code": "51"
}
```

#### æ¢æ¬¾ 26 - è£ç½°æ¡ˆä»¶
```json
{
  "company_code": "2809",
  "company_name": "äº¬åŸéŠ€",
  "title": "ä»£å­å…¬å¸äº¬åŸè­‰åˆ¸å…¬å‘Šå—é‡‘ç®¡æœƒè£ç½°æ¡ˆ",
  "clause_code": "26"
}
```

## ğŸ—„ï¸ è³‡æ–™åº«å„²å­˜

### 1. **JSON æª”æ¡ˆ**

#### æª”æ¡ˆæ ¼å¼
```json
[
  {
    "company_code": "2327",
    "company_name": "åœ‹å·¨",
    "title": "å…¬å‘Šæœ¬å…¬å¸è‚¡ç¥¨é¢é¡è®Šæ›´",
    "date": "114/08/18",
    "time": "16:30:15",
    "clause_code": "51",
    "detail_content": "...",
    "created_at": "2025-08-18T12:49:56.554725200Z"
  }
]
```

#### å„²å­˜ä½ç½®
- æª”æ¡ˆåç¨±ï¼š`twse_announcements_YYYYMMDD.json`
- åŒ…å«å®Œæ•´çš„æ¢æ¬¾ä»£è™Ÿè³‡è¨Š

### 2. **MongoDB é›†åˆ**

#### æ–‡ä»¶çµæ§‹
```javascript
{
  "_id": ObjectId("..."),
  "company_code": "2327",
  "company_name": "åœ‹å·¨",
  "title": "å…¬å‘Šæœ¬å…¬å¸è‚¡ç¥¨é¢é¡è®Šæ›´",
  "date": "114/08/18",
  "time": "16:30:15",
  "clause_code": "51",
  "detail_content": "...",
  "created_at": ISODate("2025-08-18T12:49:56.554Z")
}
```

#### ç´¢å¼•å»ºè­°
```javascript
// ç‚ºæ¢æ¬¾ä»£è™Ÿå»ºç«‹ç´¢å¼•ä»¥æå‡æŸ¥è©¢æ•ˆèƒ½
db.announcements.createIndex({ "clause_code": 1 })
db.announcements.createIndex({ "clause_code": 1, "date": 1 })
```

## ğŸ” æŸ¥è©¢åŠŸèƒ½

### 1. **æ¢æ¬¾ä»£è™Ÿç¯©é¸**

#### MongoDB æŸ¥è©¢
```javascript
// æŸ¥è©¢ç‰¹å®šæ¢æ¬¾ä»£è™Ÿ
db.announcements.find({ "clause_code": "12" })

// æŸ¥è©¢å¤šå€‹æ¢æ¬¾ä»£è™Ÿ
db.announcements.find({ "clause_code": { $in: ["12", "51", "26"] } })

// æ¢æ¬¾ä»£è™Ÿèˆ‡æ—¥æœŸçµ„åˆæŸ¥è©¢
db.announcements.find({ 
  "clause_code": "12", 
  "date": "114/08/18" 
})
```

#### API æŸ¥è©¢ç¯„ä¾‹
```
GET /api/announcements?clause_code=12
GET /api/announcements?clause_code=51&date=2025-08-18
```

### 2. **çµ±è¨ˆåˆ†æ**

#### æ¢æ¬¾ä»£è™Ÿåˆ†å¸ƒçµ±è¨ˆ
```javascript
// çµ±è¨ˆå„æ¢æ¬¾ä»£è™Ÿçš„ä½¿ç”¨é »ç‡
db.announcements.aggregate([
  { $group: { 
    _id: "$clause_code", 
    count: { $sum: 1 } 
  }},
  { $sort: { count: -1 } }
])
```

## ğŸ§ª æ¸¬è©¦é©—è­‰

### 1. **åŠŸèƒ½æ¸¬è©¦**

#### åŸ·è¡Œè³‡æ–™æ“·å–
```bash
./target/release/twse-announcements.exe --date 2025-08-18 --format json --save-mongodb
```

#### é æœŸçµæœ
- âœ… æˆåŠŸæ“·å–æ¢æ¬¾ä»£è™Ÿ
- âœ… JSON æª”æ¡ˆåŒ…å« `clause_code` æ¬„ä½
- âœ… MongoDB æ–‡ä»¶åŒ…å«æ¢æ¬¾ä»£è™Ÿ
- âœ… Web ä»‹é¢é¡¯ç¤ºæ¢æ¬¾æ¨™ç±¤

### 2. **Web ä»‹é¢æ¸¬è©¦**

#### é–‹å•Ÿ Web æŸ¥è©¢
```
http://127.0.0.1:3000
```

#### æª¢æŸ¥é …ç›®
- âœ… å…¬å‘Šæ¨™é¡Œæ—é¡¯ç¤ºæ¢æ¬¾ä»£è™Ÿæ¨™ç±¤
- âœ… CSV åŒ¯å‡ºåŒ…å«æ¢æ¬¾ä»£è™Ÿæ¬„ä½
- âœ… æ¢æ¬¾ä»£è™Ÿä»¥è—è‰²æ¨™ç±¤é¡¯ç¤º
- âœ… åœ–ç¤ºä½¿ç”¨æ³•æ§Œ (gavel) ç¬¦è™Ÿ

### 3. **è³‡æ–™å®Œæ•´æ€§é©—è­‰**

#### æª¢æŸ¥æ“·å–ç‡
```bash
# æª¢æŸ¥æœ‰æ¢æ¬¾ä»£è™Ÿçš„å…¬å‘Šæ¯”ä¾‹
grep -c "clause_code" twse_announcements_20250818.json
```

#### é©—è­‰æ¢æ¬¾ä»£è™Ÿæ ¼å¼
- æ¢æ¬¾ä»£è™Ÿæ‡‰ç‚ºæ•¸å­—å­—ä¸²
- å¸¸è¦‹å€¼ï¼š12, 51, 26, 31, 14, 53, 22, 23 ç­‰
- ç„¡æ¢æ¬¾ä»£è™Ÿæ™‚ç‚º `null`

## ğŸ¯ åŠŸèƒ½å„ªå‹¢

### 1. **è³‡æ–™å®Œæ•´æ€§**
- âœ… å®Œæ•´æ“·å–åŸå§‹ HTML ä¸­çš„æ¢æ¬¾ä»£è™Ÿ
- âœ… ä¿æŒè³‡æ–™çš„åŸå§‹æ€§å’Œæº–ç¢ºæ€§
- âœ… æ”¯æ´æ‰€æœ‰æ¢æ¬¾ä»£è™Ÿæ ¼å¼

### 2. **æŸ¥è©¢ä¾¿åˆ©æ€§**
- âœ… å¯æŒ‰æ¢æ¬¾ä»£è™Ÿç¯©é¸å…¬å‘Š
- âœ… æ”¯æ´æ¢æ¬¾ä»£è™Ÿçµ±è¨ˆåˆ†æ
- âœ… ä¾¿æ–¼æ³•è¦éµå¾ªæª¢æŸ¥

### 3. **è¦–è¦ºåŒ–å±•ç¤º**
- âœ… Web ä»‹é¢ç›´è§€é¡¯ç¤ºæ¢æ¬¾ä»£è™Ÿ
- âœ… ä¸åŒæ¢æ¬¾ä»£è™Ÿå¯ç”¨ä¸åŒé¡è‰²å€åˆ†
- âœ… æå‡ä½¿ç”¨è€…é«”é©—

### 4. **è³‡æ–™åˆ†æ**
- âœ… æ”¯æ´æ¢æ¬¾ä»£è™Ÿè¶¨å‹¢åˆ†æ
- âœ… å¯çµ±è¨ˆå„é¡å…¬å‘Šçš„åˆ†å¸ƒ
- âœ… ä¾¿æ–¼ç›£ç®¡æ©Ÿæ§‹åˆ†æ

## ğŸš€ ä½¿ç”¨æ–¹å¼

### 1. **è³‡æ–™æ“·å–**
```bash
# æ“·å–ä»Šæ—¥è³‡æ–™ä¸¦å­˜å…¥ JSON å’Œ MongoDB
./target/release/twse-announcements.exe --date 2025-08-18 --format json --save-mongodb
```

### 2. **Web æŸ¥è©¢**
```bash
# å•Ÿå‹• Web æœå‹™å™¨
./target/release/simple_web_server.exe

# é–‹å•Ÿç€è¦½å™¨
http://127.0.0.1:3000
```

### 3. **API æŸ¥è©¢**
```bash
# æŸ¥è©¢æ‰€æœ‰å…¬å‘Š
curl http://127.0.0.1:3000/api/announcements

# æŸ¥è©¢ç‰¹å®šæ¢æ¬¾ä»£è™Ÿ
curl "http://127.0.0.1:3000/api/announcements?clause_code=12"
```

## ğŸ‰ å¯¦ç¾æˆæœ

### æˆåŠŸæ“·å–
- âœ… **æ¢æ¬¾ä»£è™Ÿæ¬„ä½**: æ–°å¢ `clause_code` æ¬„ä½åˆ°æ‰€æœ‰è³‡æ–™çµæ§‹
- âœ… **HTML è§£æ**: æˆåŠŸå¾ `name='h06'` ç­‰æ¬„ä½æ“·å–æ¢æ¬¾ä»£è™Ÿ
- âœ… **JSON å„²å­˜**: æ¢æ¬¾ä»£è™ŸåŒ…å«åœ¨ JSON è¼¸å‡ºä¸­
- âœ… **MongoDB å„²å­˜**: æ¢æ¬¾ä»£è™Ÿå­˜å…¥ MongoDB æ–‡ä»¶

### Web ä»‹é¢å¢å¼·
- âœ… **è¦–è¦ºæ¨™ç±¤**: æ¢æ¬¾ä»£è™Ÿä»¥è—è‰²æ¨™ç±¤é¡¯ç¤ºåœ¨æ¨™é¡Œæ—
- âœ… **CSV åŒ¯å‡º**: åŒ¯å‡ºæª”æ¡ˆåŒ…å«æ¢æ¬¾ä»£è™Ÿæ¬„ä½
- âœ… **åœ–ç¤ºè¨­è¨ˆ**: ä½¿ç”¨æ³•æ§Œåœ–ç¤ºè¡¨ç¤ºæ¢æ¬¾ä»£è™Ÿ

### æŠ€è¡“å„ªå‹¢
- âœ… **å®Œæ•´æ€§**: æ“·å–æ‰€æœ‰å¯èƒ½çš„æ¢æ¬¾ä»£è™Ÿæ ¼å¼
- âœ… **æº–ç¢ºæ€§**: ç²¾ç¢ºåŒ¹é… HTML input æ¬„ä½
- âœ… **æ“´å±•æ€§**: æ”¯æ´æœªä¾†æ–°å¢çš„æ¢æ¬¾ä»£è™Ÿæ ¼å¼
- âœ… **èª¿è©¦æ€§**: è©³ç´°çš„æ“·å–æ—¥èªŒä¾¿æ–¼å•é¡Œæ’æŸ¥

ç¾åœ¨ä½ å¯ä»¥å®Œæ•´åœ°æ“·å–ã€å„²å­˜ã€æŸ¥è©¢å’Œé¡¯ç¤ºè­‰äº¤æ‰€é‡å¤§è¨Šæ¯çš„æ¢æ¬¾ä»£è™Ÿè³‡è¨Šï¼ğŸŠ
